---
layout: post
title:  "PHP5与7的各种Hash算法分析"
date:   2017-10-10 13:31:01 +0800
categories: 技术
tag: PHP
---

* content
{:toc}


好久没有写文章了，今天在对公司源码个人重构整理分析中，突然发现有关于Hash的算法。于是就觉得应该写点啥了。

首先，我们来看看什么是Hash
>哈希算法将任意长度的二进制值映射为较短的固定长度的二进制值，这个小的二进制值称为哈希值。哈希值是一段数据唯一且极其紧凑的数值表示形式。如果散列一段明文而且哪怕只更改该段落的一个字母，随后的哈希都将产生不同的值。要找到散列为同一个值的两个不同的输入，在计算上是不可能的，所以数据的哈希值可以检验数据的完整性。一般用于快速查找和加密算法。
——百度百科


我们可以根据这段话得知，任何文件在计算机中都是可以用二进制来表示的。然后Hash就是将这些二进制转换为较短的二进制。这个较短的二进制就称为Hash。而且由于种种算法导致了该Hash是唯一的。

于是乎，我就想起公司的环境是PHP5.2.3，而我自己搭建的是PHP7.0.12。基于此，我来做一个测试代码。

```php
        #测试的字符串大小
        $test = 100000;

        $algos = hash_algos();

        #循环测试所有Hash算法
        foreach($algos as $algo) {

            $startTime = microtime();

            for($i = 0; $i < $test; $i++) {
                hash($algo, microtime().$i);
            }

            $endTime = microtime();

            list($ss, $si) = explode(' ', $startTime);
            list($es, $ei) = explode(' ', $endTime);

            $time[$algo] = $ei + $es - $si - $ss;
        }

        #按时间排序
        asort($time, SORT_NUMERIC);

        print_r($time);
```

然后我们直接看测试结果

```php
        #PHP 7.0.12测试结果
        Array (
            [fnv132] => 0.1404789909668
            [adler32] => 0.14321789131165
            [fnv1a32] => 0.14741105944824
            [crc32] => 0.15086297607422
            [crc32b] => 0.15108788955688
            [fnv1a64] => 0.15410994790649
            [fnv164] => 0.15583607893372
            [md4] => 0.1577820244751
            [joaat] => 0.16283402952576
            [sha1] => 0.16448107337952
            [md5] => 0.16647399621582
            [tiger128,3] => 0.17234995147705
            [ripemd128] => 0.18408809310913
            [tiger192,3] => 0.18744609455872
            [tiger192,4] => 0.18848092152405
            [tiger160,3] => 0.19003210934448
            [ripemd256] => 0.19060309550476
            [ripemd160] => 0.19414492514038
            [sha256] => 0.1967020803833
            [sha224] => 0.19886492434692
            [ripemd320] => 0.20380397943115
            [tiger160,4] => 0.21733691493225
            [haval160,3] => 0.21757588470459
            [haval192,3] => 0.2185330300293
            [haval256,3] => 0.22083305491638
            [haval224,3] => 0.22313207765198
            [tiger128,4] => 0.22447396194458
            [haval128,3] => 0.24406494364929
            [haval160,4] => 0.24815107403564
            [haval224,4] => 0.2492679095459
            [haval128,4] => 0.24963609597778
            [haval192,4] => 0.25094794044495
            [haval256,4] => 0.25518900405884
            [haval224,5] => 0.26357997990417
            [haval192,5] => 0.26363398191833
            [haval128,5] => 0.26574698851013
            [haval160,5] => 0.26661310133362
            [haval256,5] => 0.26721896066284
            [whirlpool] => 0.300298061203
            [sha512] => 0.32748794883728
            [sha384] => 0.32798408914185
            [gost-crypto] => 0.40015293670654
            [gost] => 0.41127190879822
            [snefru] => 0.60410597715759
            [snefru256] => 0.64501499203491
            [md2] => 0.80822788677979
        )
```

```php
        #PHP5.2.3测试结果
        Array (
            [crc32b] => 0.455004883789
            [crc32] => 0.46198707869
            [adler32] => 0.478047993408
            [md5] => 0.485403898392
            [md4] => 0.485650009201
            [sha1] => 0.499910889191
            [tiger160,3] => 0.515793086823
            [tiger128,3] => 0.518863080795
            [tiger192,4] => 0.522827073883
            [ripemd128] => 0.53010811293
            [tiger160,4] => 0.533369097168
            [tiger192,3] => 0.535187921097
            [haval224,3] => 0.535988905441
            [haval192,3] => 0.538183984741
            [ripemd256] => 0.541414949448
            [sha256] => 0.544070074326
            [haval160,3] => 0.544199944183
            [tiger128,4] => 0.548405919815
            [haval128,3] => 0.551922079712
            [ripemd320] => 0.562585893158
            [ripemd160] => 0.569184052399
            [haval224,5] => 0.572654034485
            [haval256,3] => 0.578612889572
            [haval256,5] => 0.584351925537
            [haval192,4] => 0.587839090134
            [haval160,5] => 0.593244932816
            [haval128,4] => 0.593339922638
            [haval256,4] => 0.599071034775
            [haval192,5] => 0.606186104691
            [haval224,4] => 0.606725895905
            [haval160,4] => 0.612153088943
            [haval128,5] => 0.630741982437
            [gost] => 0.731288986313
            [whirlpool] => 0.748385005051
            [sha384] => 0.806623884628
            [sha512] => 0.816874071228
            [snefru] => 0.822834963379
            [md2] => 3.08673211836
        )
```

从结果上看，首先我们粗略的看出，对比于PHP5与PHP7来说

1. Hash算法的种类增加
2. Hash算法的效率大幅度提高

我们在往细节处看，一个个分分析吧。

FNV
==

FNV（Fowler–Noll–Vo），是一种基于非零偏移的一种算法。属于不加密的Hash。

Adler-32
==

Adler-32是一种校验算法，是由Mark Adler在1995年发明的，故取此名。这是一种修改的Fletcher校验。

CRC
==

CRC（Cyclic Redundancy Check），中文名为循环冗余校验。这是一种相当常见的校验方法。编码和解码方法简单，检错和纠错能力强，在通信领域广泛地用于实现差错控制。除了数据通信外，CRC在数据存储等方法也会常常涉及到。

MD4
==

MD4是MIT的Ronald L.Rivest在1990 年设计的，MD 是 Message Digest 的缩写。它适用在32位字长的处理器上用高速软件实现--它是基于 32 位操作数的位操作来实现的。

SHA
==

SHA（Secure Hash Algorithm），中文名为安全哈希算法。该算法也是广为人知，出现的频率也是相当之高。该算法还是美国国家标准技术研究所发布的国家标准FIPS PUB 180，最新的标准已经于2008年更新到FIPS PUB 180-3。其中规定了SHA-1，SHA-224，SHA-256，SHA-384，和SHA-512这几种单向散列算法。

但是由于计算机已经变得越来越快，所以SHA-1已经被人们逐渐所抛弃。

MD5
==

MD5(RFC 1321)是 Rivest 于1991年对MD4的改进版本。它对输入仍以512位分组，其输出是4个32位字的级联，与 MD4 相同。MD5比MD4来得复杂，并且速度较之要慢一点，但更安全，在抗分析和抗差分方面表现更好。 

MD5是一种不可逆的加密算法，目前是最牢靠的加密算法之一，尚没有能够逆运算的程序被开发出来，它对应任何字符串都可以加密成一段唯一的固定长度的代码。 

Tiger
==

该Hash函数是在1995年，Ross Anderson和Eli Biham在64位平台中设计出来的。号称是现代计算机中最新最快速的Hash函数，尤其是在64位的计算机中。

当然，已经被MD5和SHA-1给打破了：）


RIPEMD
==
RIPEMD (RACE Integrity Primitives Evaluation Message Digest)，首次发表于1996年，是基于MD4算法设计原则下进行开发的，因此在性能上比较类似于当时流行的SHA-1

HAVAL
==

这是一种加密的Hash函数，不像MD5，但像大多数现代的加密散列函数散列。是由Yuliang Zheng, Josef Pieprzyk, 和Jennifer Seberry于1992年发明的。

Whirlpool
==
这是一种加密算法，是加密散列函数。它是由Vincent Rijmen (高级加密标准的共同创造者)和Paulo S. L. M. Barreto在2000年发明的。

它已经通过ISO和IEC作为ISO/IEC10118-3国际标准的一部分。


GHOST
==

GHOST散列函数，最初是在俄罗斯国家标准GOST R 34.11-94定义的密码信息安全散列函数。

Senfru
==

该Hash函数是由Ralph Merkle于1990年在Xerox PARC工作的时候发明的。它以埃及法老Sneferu命名。

MD2
==

MD2消息摘要算法是由Ronald Rivest于1989年开发的加密散列函数。该算法是针对8位计算机进行的优化。


总结
==

**PHP7的确比PHP5不是一点半点，有条件的话还是能升级就升级吧。**

**CRC是冗余验证算法，不适合用来做唯一标识符Hash计算**

行了，准备收拾收拾回家吃饭了，据说今晚有猪心猪肝猪大肠吃。


      